Private Sub CommandButton7_Click()
    ' Initialize the variable
    Dim selectedCheckboxes As String
    selectedCheckboxes = ""
    
    Dim qgc As String
    qgc = ThisWorkbook.Sheets("Sheet1").Range("C14").value
    
    Dim targetSheet As Worksheet
    Set targetSheet = ThisWorkbook.Sheets("Sheet3")
    
    Dim appendedValue As String
    
    TextBox9.Enabled = False
    TextBox10.Enabled = False
    
    Dim lastRow As Long
    lastRow = targetSheet.Cells(targetSheet.Rows.Count, "A").End(xlUp).Row + 1 ' Find the last empty row in Sheet3
    
    ' Check each checkbox
    Dim i As Integer
     For i = 1 To 7
        If Me.Controls("CheckBox" & i).value = True Then
           
            If qgc = "QGC0" Then
                
                If i = 1 Then
                    targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A4:J5").value
                    targetSheet.Range("H" & lastRow + 1).value = TextBox9.value  ' Replace column H values with TextBox9 value
                    appendedValue = "" & targetSheet.Cells(lastRow + 1, "J").value & " , " & TextBox10.value
                    targetSheet.Range("J" & lastRow + 1).value = appendedValue  ' Append column J values with TextBox10 value
                    lastRow = lastRow + 2 ' Move to the next empty row
                End If
                
                ' Add the checkbox label to the selectedCheckboxes string
                If i = 2 Then
                    targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A6:J7").value
                    lastRow = lastRow + 2 ' Move to the next empty row
                End If
                
                Dim row13Pasted As Boolean
                Dim row14Pasted As Boolean
                Dim row15Pasted As Boolean
                Dim row16Pasted As Boolean
                
                row13Pasted = False
                row14Pasted = False
                row15Pasted = False
                row16Pasted = False
                
                ' Check if any of CheckBoxes 3, 4, or 6 are selected
                If Me.CheckBox3.value Or Me.CheckBox4.value Or Me.CheckBox6.value Then
                    ' Paste row 13 from "Sheet2" if it hasn't been pasted yet
                    If Not row13Pasted Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A13:J13").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        row13Pasted = True ' Mark row 13 as pasted
                    End If
                
                    ' Paste row 14 from "Sheet2" if checkbox 3 is selected and row 14 hasn't been pasted yet
                    If Me.CheckBox3.value And Not row14Pasted Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A14:J14").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        row14Pasted = True ' Mark row 14 as pasted
                    End If
                    
                    ' Paste row 15 from "Sheet2" if checkbox 6 is selected and row 15 hasn't been pasted yet
                    If Me.CheckBox6.value And Not row15Pasted Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A15:J15").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        row15Pasted = True ' Mark row 15 as pasted
                    End If
                    
                    ' Paste row 16 from "Sheet2" if checkbox 4 is selected and row 16 hasn't been pasted yet
                    If Me.CheckBox4.value And Not row16Pasted Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A16:J16").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        row16Pasted = True ' Mark row 16 as pasted
                    End If
                End If


                ' Paste data for checkboxes 5 and 7
                If i = 5 Then
                    targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A11:J12").value
                    lastRow = lastRow + 2 ' Move to the next empty row
                End If
                
                If i = 7 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A8:J10").value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                
                    ' Update selectedCheckboxes
                     selectedCheckboxes = selectedCheckboxes & " Checkbox " & i & ", "
                     
               ElseIf qgc = "QGC2" Then
               
                If i = 2 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A23:J25").value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                
                ' Additional logic for CheckBoxes 1 and 3
                If i = 1 Or i = 3 Then
                    ' Check if CheckBoxes 1 and 3 are selected together
                    Dim checkboxes13Selected As Boolean
                    checkboxes13Selected = (Me.CheckBox1.value And Me.CheckBox3.value)
                    
                    ' If CheckBoxes 1 and 3  are selected together,
                    If checkboxes13Selected And i = 1 Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A20:J20").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A26:J28").value
                        lastRow = lastRow + 3 ' Move to the next empty row
                    End If
                    
                    ' Clear checkboxes individually if CheckBoxes 1 and 3 are not selected together
                    If i = 1 And Not checkboxes13Selected Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A20:J20").value
                        lastRow = lastRow + 1 ' Move to the next empty row.
                        targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A26:J27").value
                        lastRow = lastRow + 2 ' Move to the next empty row
                    End If
                    
                    If i = 3 And Not checkboxes13Selected Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A20:J20").value
                        lastRow = lastRow + 1 ' Move to the next empty row.
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A28:J28").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                    End If
                End If
                
                selectedCheckboxes = selectedCheckboxes & "Special Checkbox " & i & ", "
        
            ElseIf qgc = "QGC4" Then
                If i = 1 Then
                        targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A32:J33").value
                        lastRow = lastRow + 2 ' Move to the next empty row
                End If
                If i = 2 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A34:J36").value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                If i = 3 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A37:J39").value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                If i = 4 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A40:J42").value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                
                ' Additional logic for CheckBoxes 1 and 3
                If i = 5 Or i = 6 Then
                    ' Check if CheckBoxes 1 and 3 are selected together
                    Dim checkboxes56Selected As Boolean
                    checkboxes56Selected = (Me.CheckBox5.value And Me.CheckBox6.value)
                    
                    ' If CheckBoxes 1 and 3  are selected together,
                    If checkboxes56Selected And i = 5 Then
                        targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A43:J45").value
                        lastRow = lastRow + 3 ' Move to the next empty row
                    End If
                    
                    ' Clear checkboxes individually if CheckBoxes 1 and 3 are not selected together
                    If i = 5 And Not checkboxes56Selected Then
                          targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A43:J44").value
                          lastRow = lastRow + 2 ' Move to the next empty row
                    End If
                    
                    If i = 6 And Not checkboxes56Selected Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A43:J43").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A45:J45").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                    End If
                  End If
                
                selectedCheckboxes = selectedCheckboxes & "Special Checkbox " & i & ", "
            
            End If
        End If
     Next i
    
    ' Remove trailing comma and space
    selectedCheckboxes = Left(selectedCheckboxes, Len(selectedCheckboxes) - 2)
    
    ' Display the selected checkboxes
    MsgBox "Selected checkboxes: " & selectedCheckboxes
End Sub
