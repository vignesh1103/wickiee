Option Explicit

Dim previousTextBox8Value As String
Dim storedDataList As New Collection
Dim ws As Worksheet
Dim inputCount As Integer ' Initialize inputCount variable

Private Sub UserForm_Initialize()
    ' Set the worksheet to which data will be copied
    Set ws = Sheets("Sheet3")
    
    ' Initialize inputCount variable
    inputCount = 0
    
    ' Rest of the code remains the same
    ' ...
End Sub

Private Sub TextBox8_Change()
    ' Check if this is the first input or user has entered something new in textbox8
    If previousTextBox8Value = "" Or TextBox8.Value <> previousTextBox8Value Then
        ' Prompt user to change deliverable
        Dim response As VbMsgBoxResult
        response = MsgBox("Do you want to change the deliverable?", vbYesNo)
        
        ' If user selects "Yes", clear all inputs except TextBox8 and do logic 1
        If response = vbYes Then
            Call ClearAllInputsExceptTextBox8
        End If
        
        ' If user selects "No" or it's the first input, clear all inputs and do logic 2
        If response = vbNo Or inputCount = 0 Then
            Call ClearAllInputs
        End If
        
        ' Update previousTextBox8Value
        previousTextBox8Value = TextBox8.Value
        
        ' Increment inputCount
        inputCount = inputCount + 1
    End If
End Sub

Private Sub ClearAllInputsExceptTextBox8()
    ' Clear all input controls except TextBox8
    TextBox2.Value = ""
    TextBox3.Value = ""
    TextBox4.Value = ""
    TextBox5.Value = ""
    TextBox23.Value = ""
    TextBox24.Value = ""
End Sub

Private Sub ClearAllInputs()
    ' Clear all input controls
    TextBox8.Value = ""
    TextBox2.Value = ""
    TextBox3.Value = ""
    TextBox4.Value = ""
    TextBox5.Value = ""
    TextBox23.Value = ""
    TextBox24.Value = ""
End Sub
