Private Sub CommandButton3_Click()
    Dim sourceRange As Range
    Dim targetRange As Range
    Dim appendedValue As String
    Dim textBox8Value As String
    Dim textBox2Value As String
    Dim textBox3Value As String
    Dim textBox4Value As String
    Dim textBox5Value As String
    Dim textBox23value As String
    Dim textBox24value As String
    
    ' Get the values from the textboxes
    textBox8Value = Trim(TextBox8.Value)
    textBox2Value = Trim(TextBox2.Value)
    textBox3Value = Trim(TextBox3.Value)
    textBox4Value = Trim(TextBox4.Value)
    textBox5Value = Trim(TextBox5.Value)
    textBox23value = Trim(TextBox23.Value)
    textBox24value = Trim(TextBox24.Value)
    
    ' Determine source range based on previousTextBox8Value
    If previousTextBox8Value = "" Then
        ' For the first input, source range is A48:J49
        Set sourceRange = Sheets("Sheet2").Range("A48:J49")
    Else
        ' After the first input, source range is A49:J49
        Set sourceRange = Sheets("Sheet2").Range("A49:J49")
    End If
    
    ' Determine target range in Sheet3
    Set targetRange = Sheets("Sheet3").Cells(Sheets("Sheet3").Rows.Count, "A").End(xlUp).Offset(1, 0)
    
    ' Copy sourceRange to targetRange
    sourceRange.Copy Destination:=targetRange
    
    ' Manipulate and paste data in Sheet3
    appendedValue = "- " & textBox8Value & " (" & textBox2Value & ")"
    targetRange.Cells(1, 3).Value = appendedValue
    targetRange.Cells(1, 4).Value = textBox3Value
    targetRange.Cells(1, 11).Value = textBox4Value
    targetRange.Cells(1, 9).Value = textBox5Value
    targetRange.Cells(1, 8).Value = textBox23value
    targetRange.Cells(1, 10).Value = textBox24value
    
    ' Update previousTextBox8Value
    previousTextBox8Value = textBox8Value
End Sub
