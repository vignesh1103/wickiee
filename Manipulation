Dim Del_change As Boolean
Dim isFirstInstance As Boolean

Private Sub CommandButton8_Click()
    Dim response As VbMsgBoxResult
    
    response = MsgBox("Are you sure you want to change the deliverable?", vbYesNo)
    
    If response = vbYes Then
        Del_change = True
    Else
        Del_change = False
    End If
    
    Additional_Items
End Sub

Private Sub CommandButton3_Click()
    If isFirstInstance Then
        isFirstInstance = False
    End If
    
    Additional_Items
End Sub

Private Sub Additional_Items()
    Dim lastRow As Long
    
    If Del_change Then
        ' Clear all inputs and enable TextBox8
        ClearAllInputs
        TextBox8.Enabled = True
        ' Copy rows from sheet2 to sheet3 (two rows)
        lastRow = Sheets("Sheet3").Cells(Sheets("Sheet3").Rows.Count, "A").End(xlUp).Row + 1
        Sheets("Sheet2").Rows("48:49").Copy Destination:=Sheets("Sheet3").Range("A" & lastRow)
        ' Manipulate rows in sheet3 using TextBox values
        ManipulateData lastRow, TextBox8.Value, TextBox2.Value, TextBox3.Value, TextBox4.Value, TextBox5.Value, TextBox23.Value, TextBox24.Value
    Else
        ' Clear all inputs except TextBox8 and disable TextBox8
        ClearAllInputsExceptTextBox8
        TextBox8.Enabled = False
        ' Copy rows from sheet2 to sheet3 (one row)
        lastRow = Sheets("Sheet3").Cells(Sheets("Sheet3").Rows.Count, "A").End(xlUp).Row + 1
        Sheets("Sheet2").Rows("49:49").Copy Destination:=Sheets("Sheet3").Range("A" & lastRow)
        ' Manipulate rows in sheet3 using TextBox values
        ManipulateData lastRow, TextBox8.Value, TextBox2.Value, TextBox3.Value, TextBox4.Value, TextBox5.Value, TextBox23.Value, TextBox24.Value
    End If
End Sub

Private Sub ManipulateData(ByVal startRow As Long, ByVal value8 As String, ByVal value2 As String, ByVal value3 As String, ByVal value4 As String, ByVal value5 As String, ByVal value23 As String, ByVal value24 As String)
    With Sheets("Sheet3")
        .Range("C" & startRow).Value = value8 & " (" & value2 & ")"
        .Range("D" & startRow).Value = value3
        .Range("K" & startRow).Value = value4
        .Range("I" & startRow).Value = value5
        .Range("H" & startRow).Value = value23
        .Range("J" & startRow).Value = value24
    End With
End Sub

Private Sub ClearAllInputs()
    TextBox2.Value = ""
    TextBox3.Value = ""
    TextBox4.Value = ""
    TextBox5.Value = ""
    TextBox8.Value = ""
    TextBox23.Value = ""
    TextBox24.Value = ""
End Sub

Private Sub ClearAllInputsExceptTextBox8()
    TextBox2.Value = ""
    TextBox3.Value = ""
    TextBox4.Value = ""
    TextBox5.Value = ""
    TextBox23.Value = ""
    TextBox24.Value = ""
End Sub

Private Sub UserForm_Initialize()
    isFirstInstance = True
    Del_change = False ' Setting initial value of Del_change to False
End Sub
