Private Sub CommandButton3_Click()
    Dim sourceRange As Range
    Dim targetRange As Range
    Dim appendedValue As String
    Dim textBox8Value As String
    Dim textBox2Value As String
    Dim textBox3Value As String
    Dim textBox4Value As String
    Dim textBox5Value As String
    Dim textBox23value As String
    Dim textBox24value As String
    
    ' Get the values from TextBoxes
    textBox8Value = Trim(TextBox8.Value)
    textBox2Value = Trim(TextBox2.Value)
    textBox3Value = Trim(TextBox3.Value)
    textBox4Value = Trim(TextBox4.Value)
    textBox5Value = Trim(TextBox5.Value)
    textBox23value = Trim(TextBox23.Value)
    textBox24value = Trim(TextBox24.Value)
    
    ' Check if it's the first input
    If previousTextBox8Value = "" Then
        ' For the first input, source range is A48:J49
        Set sourceRange = Sheets("Sheet2").Range("A48:J49")
        Set targetRange = Sheets("Sheet3").Cells(Sheets("Sheet3").Rows.Count, "A").End(xlUp).Offset(1, 0)
        sourceRange.Copy Destination:=targetRange
        ManipulateAndPasteData textBox8Value, textBox2Value, textBox3Value, textBox4Value, textBox5Value, textBox23value, textBox24value, 1
        Call ClearAllInputsExceptTextBox8
    Else
        ' Check if TextBox8 value has changed after the first input
        If TextBox8.Value <> previousTextBox8Value Then
            ' Prompt the user to confirm if they want to change the Deliverable
            Dim response As VbMsgBoxResult
            response = MsgBox("Do you want to change the Deliverable?", vbYesNo)
            If response = vbYes Then
                ' Clear all inputs and work with Logic 1
                Call ClearAllInputs
                Set sourceRange = Sheets("Sheet2").Range("A48:J49")
                Set targetRange = Sheets("Sheet3").Cells(Sheets("Sheet3").Rows.Count, "A").End(xlUp).Offset(1, 0)
                sourceRange.Copy Destination:=targetRange
                ManipulateAndPasteData textBox8Value, textBox2Value, textBox3Value, textBox4Value, textBox5Value, textBox23value, textBox24value, 1
                Call ClearAllInputsExceptTextBox8
            Else
                ' Clear all inputs except TextBox8 and work with Logic 2
                Call ClearAllInputsExceptTextBox8
                Set sourceRange = Sheets("Sheet2").Range("A49:J49")
                Set targetRange = Sheets("Sheet3").Cells(Sheets("Sheet3").Rows.Count, "A").End(xlUp).Offset(1, 0)
                sourceRange.Copy Destination:=targetRange
                ManipulateAndPasteData textBox8Value, textBox2Value, textBox3Value, textBox4Value, textBox5Value, textBox23value, textBox24value, 2
            End If
        Else
            ' If TextBox8 value hasn't changed after the first input, work with Logic 2
            Call ClearAllInputs
            Set sourceRange = Sheets("Sheet2").Range("A49:J49")
            Set targetRange = Sheets("Sheet3").Cells(Sheets("Sheet3").Rows.Count, "A").End(xlUp).Offset(1, 0)
            sourceRange.Copy Destination:=targetRange
            ManipulateAndPasteData textBox8Value, textBox2Value, textBox3Value, textBox4Value, textBox5Value, textBox23value, textBox24value, 2
        End If
    End If
    
    ' Update the previousTextBox8Value
    previousTextBox8Value = TextBox8.Value
End Sub
