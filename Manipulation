Dim isFirstUserInput As Boolean
Dim runRange48To49 As Boolean

Private Sub UserForm_Initialize()
       isFirstUserInput = True
ENd Sub

Sub Loader()
    Dim rng As Range
    
   If isFirstUserInput Then
       isFirstUserInput = False ' Set flag to false after processing first user input
       Set rng = ThisWorkbook.Sheets("Sheet2").Range("A48:J49")
   Else
        If runRange48To49 Then
            Call ClearAllInputs
            Set rng = ThisWorkbook.Sheets("Sheet2").Range("A48:J49")
        Else
            Set rng = ThisWorkbook.Sheets("Sheet2").Range("A49:J49")
        End If
    End If
    
    ProcessRowRange rng
    MsgBox "work item added .", vbInformation
    Call ClearAllInputsExceptTextBox8
End Sub

Private Sub CommandButton3_Click()
        ' Call Loader to process the range and paste the data
        Loader
End Sub

Private Sub CommandButton8_Click()
    If MsgBox("Are you sure you want to change TextBox8?", vbYesNo + vbQuestion, "Confirm TextBox8 Change") = vbYes Then
        runRange48To49 = True
    Else
        runRange48To49 = False
    End If
    Loader
End Sub

Sub ProcessRowRange(rng As Range)
    Dim wsDestination As Worksheet
    Dim destinationRange As Range
    Dim lastRow As Long
    Dim i As Integer
    
    ' Set the destination worksheet (Sheet3) and starting cell
    Set wsDestination = ThisWorkbook.Sheets("Sheet3")
    lastRow = wsDestination.Cells(wsDestination.Rows.Count, "A").End(xlUp).Row ' Adjust to column A
    
    Set destinationRange = wsDestination.Range("A" & lastRow + 1) ' Start pasting from column A
    
    ' Copy the original data from Sheet2 to Sheet3
    rng.Copy destinationRange
    
    ' Loop through each row and manipulate and paste data based on user inputs
    For i = 1 To rng.Rows.Count
         ' Concatenate the values from TextBox8 and TextBox2
        destinationRange.Offset(i - 1, 2).value = TextBox8.value & " (" & TextBox2.value & ")" ' Concatenate and replace in column C
        destinationRange.Offset(i - 1, 3).value = TextBox3.value ' Replace in column D
        destinationRange.Offset(i - 1, 10).value = TextBox4.value ' Replace in column K
        destinationRange.Offset(i - 1, 8).value = TextBox5.value ' Replace in column I
        destinationRange.Offset(i - 1, 7).value = TextBox23.value ' Replace in column H
        destinationRange.Offset(i - 1, 9).value = TextBox24.value ' Replace in column J
    Next i
End Sub

Private Sub ClearAllInputsExceptTextBox8()
    ' Clear all input controls except TextBox8
    TextBox2.value = ""
    TextBox3.value = ""
    TextBox4.value = ""
    TextBox5.value = ""
    TextBox23.value = ""
    TextBox24.value = ""
    
    TextBox8.Visible = True
    TextBox8.Enabled = False
End Sub

Private Sub ClearAllInputs()
    ' Clear all input controls
    TextBox8.value = ""
    TextBox2.value = ""
    TextBox3.value = ""
    TextBox4.value = ""
    TextBox5.value = ""
    TextBox23.value = ""
    TextBox24.value = ""
End Sub
