Option Explicit

Dim previousTextBox8Value As String
Dim storedDataList As New Collection
Dim ws As Worksheet
'Dim Sheet3DataObject As Object
'Dim storedData As Variant

'Private manipulatedDataList As New Collection

' variable to store data from Command Button 5
Dim userData As Collection
Private Sub CheckBox1_Click()
    If CheckBox1.value = True Then
        TextBox9.Enabled = True
        TextBox10.Enabled = True
    Else
        TextBox9.Enabled = False
        TextBox10.Enabled = False
    End If
End Sub

Private Sub CheckBox2_Click()
    If CheckBox2.value = True Then
        TextBox11.Enabled = True
        TextBox12.Enabled = True
    Else
        TextBox11.Enabled = False
        TextBox12.Enabled = False
    End If
End Sub

Private Sub CheckBox3_Click()
    If CheckBox3.value = True Then
        TextBox13.Enabled = True
        TextBox14.Enabled = True
    Else
        TextBox13.Enabled = False
        TextBox14.Enabled = False
    End If
End Sub

Private Sub CheckBox4_Click()
    If CheckBox4.value = True Then
        TextBox15.Enabled = True
        TextBox16.Enabled = True
    Else
        TextBox15.Enabled = False
        TextBox16.Enabled = False
    End If
End Sub

Private Sub CheckBox5_Click()
    If CheckBox5.value = True Then
        TextBox17.Enabled = True
        TextBox18.Enabled = True
    Else
        TextBox17.Enabled = False
        TextBox18.Enabled = False
    End If
End Sub

Private Sub CheckBox6_Click()
    If CheckBox6.value = True Then
        TextBox19.Enabled = True
        TextBox20.Enabled = True
    Else
        TextBox19.Enabled = False
        TextBox20.Enabled = False
    End If
End Sub

Private Sub CheckBox7_Click()
    If CheckBox7.value = True Then
        TextBox21.Enabled = True
        TextBox22.Enabled = True
    Else
        TextBox21.Enabled = False
        TextBox22.Enabled = False
    End If
End Sub

'7 checkboxes named CheckBox1, CheckBox2, ..., CheckBox7
Private Sub CommandButton7_Click()
    Dim checkBoxSelected As Boolean
     Dim textBoxesValidated As Boolean
     checkBoxSelected = False
     textBoxesValidated = True
     
     ' Check if any of the checkboxes are selected
     If CheckBox1.value Or CheckBox2.value Or CheckBox3.value Or CheckBox4.value Or CheckBox5.value Or CheckBox6.value Or CheckBox7.value Then
         checkBoxSelected = True
     End If
     
     ' Validate text boxes if checkboxes are selected
     If checkBoxSelected Then
         If CheckBox1.value Then
             If Trim(TextBox9.value) = "" Or Trim(TextBox10.value) = "" Then
                 textBoxesValidated = False
             End If
         End If
         If CheckBox2.value Then
             If Trim(TextBox11.value) = "" Or Trim(TextBox12.value) = "" Then
                 textBoxesValidated = False
             End If
         End If
         If CheckBox3.value Then
             If Trim(TextBox13.value) = "" Or Trim(TextBox14.value) = "" Then
                 textBoxesValidated = False
             End If
         End If
         If CheckBox4.value Then
             If Trim(TextBox15.value) = "" Or Trim(TextBox16.value) = "" Then
                 textBoxesValidated = False
             End If
         End If
         If CheckBox5.value Then
             If Trim(TextBox17.value) = "" Or Trim(TextBox18.value) = "" Then
                 textBoxesValidated = False
             End If
         End If
         If CheckBox6.value Then
             If Trim(TextBox19.value) = "" Or Trim(TextBox20.value) = "" Then
                 textBoxesValidated = False
             End If
         End If
         If CheckBox7.value Then
             If Trim(TextBox21.value) = "" Or Trim(TextBox22.value) = "" Then
                 textBoxesValidated = False
             End If
         End If
     End If
     
     ' Display warning if no checkboxes are selected
     If Not checkBoxSelected Then
         MsgBox "Warning: Please select any one Work item to Add.", vbExclamation
         Exit Sub
     End If
     
     ' Display warning if text boxes are not validated
     If Not textBoxesValidated Then
         MsgBox "Warning: Please enter Planned for and Tags.", vbExclamation
         Exit Sub
     End If
     
    ' Initialize the variable
    Dim selectedCheckboxes As String
    selectedCheckboxes = ""
    
    Dim qgc As String
    qgc = ThisWorkbook.Sheets("Sheet1").Range("C14").value
    
    Dim targetSheet As Worksheet
    Set targetSheet = ThisWorkbook.Sheets("Sheet3")
    
    Dim appendedValue As String
    
    ' Initialize variables to track whether each row has been pasted
    Dim row13Pasted As Boolean
    Dim row14Pasted As Boolean
    Dim row15Pasted As Boolean
    Dim row16Pasted As Boolean
    
    row13Pasted = False
    row14Pasted = False
    row15Pasted = False
    row16Pasted = False

    
    Dim lastRow As Long
    lastRow = targetSheet.Cells(targetSheet.Rows.Count, "A").End(xlUp).Row + 1 ' Find the last empty row in Sheet3
    
    ' Check each checkbox
    Dim i As Integer
     For i = 1 To 7
        If Me.Controls("CheckBox" & i).value = True Then
           
            If qgc = "QGC0" Then
                'iteration for checkboxes
                If i = 1 Then
                    targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A4:J5").value
                    targetSheet.Range("H" & lastRow + 1).value = TextBox9.value  ' Replace column H values with TextBox9 value
                    appendedValue = "" & targetSheet.Cells(lastRow + 1, "J").value & " , " & TextBox10.value
                    targetSheet.Range("J" & lastRow + 1).value = appendedValue  ' Append column J values with TextBox10 value
                    lastRow = lastRow + 2 ' Move to the next empty row
                End If
                
            
                If i = 2 Then
                    targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A6:J7").value
                    targetSheet.Range("H" & lastRow + 1).value = TextBox11.value  ' Replace column H values with TextBox11 value
                    appendedValue = "" & targetSheet.Cells(lastRow + 1, "J").value & " , " & TextBox12.value
                    targetSheet.Range("J" & lastRow + 1).value = appendedValue  ' Append column J values with TextBox12 value
                    lastRow = lastRow + 2 ' Move to the next empty row
                End If
                
               
                ' Check if any of CheckBoxes 3, 4, or 6 are selected
                If Me.CheckBox3.value Or Me.CheckBox4.value Or Me.CheckBox6.value Then
                    ' Paste row 13 from "Sheet2" if it hasn't been pasted yet
                    If Not row13Pasted Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A13:J13").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        row13Pasted = True ' Mark row 13 as pasted
                    End If
                
                    ' Paste row 14 from "Sheet2" if checkbox 3 is selected and row 14 hasn't been pasted yet
                    If Me.CheckBox3.value And Not row14Pasted Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A14:J14").value
                        targetSheet.Range("H" & lastRow).value = TextBox13.value   ' Replace column H values with TextBox13 value
                        appendedValue = "" & targetSheet.Cells(lastRow, "J").value & " , " & TextBox14.value
                        targetSheet.Range("J" & lastRow).value = appendedValue   ' Append column J values with TextBox14 value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        row14Pasted = True ' Mark row 14 as pasted
                    End If
                    
                     ' Paste row 15 from "Sheet2" if checkbox 6 is selected and row 15 hasn't been pasted yet
                    If Me.CheckBox6.value And Not row15Pasted Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A15:J15").value
                        targetSheet.Range("H" & lastRow).value = TextBox19.value   ' Replace column H values with TextBox19 value
                        appendedValue = "" & targetSheet.Cells(lastRow, "J").value & " , " & TextBox20.value
                        targetSheet.Range("J" & lastRow).value = appendedValue   ' Append column J values with TextBox20 value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        row15Pasted = True ' Mark row 15 as pasted
                    End If
                    
                       ' Paste row 16 from "Sheet2" if checkbox 4 is selected and row 16 hasn't been pasted yet
                    If Me.CheckBox4.value And Not row16Pasted Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A16:J16").value
                        targetSheet.Range("H" & lastRow).value = TextBox15.value   ' Replace column H values with TextBox15 value
                        appendedValue = "" & targetSheet.Cells(lastRow, "J").value & " , " & TextBox16.value
                        targetSheet.Range("J" & lastRow).value = appendedValue   ' Append column J values with TextBox20 value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        row16Pasted = True ' Mark row 16 as pasted
                    End If
                    
                End If


                ' Paste data for checkboxes 5 and 7
                If i = 5 Then
                    targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A11:J12").value
                    targetSheet.Range("H" & lastRow + 1).value = TextBox17.value  ' Replace column H values with TextBox17 value
                    appendedValue = "" & targetSheet.Cells(lastRow + 1, "J").value & " , " & TextBox18.value
                    targetSheet.Range("J" & lastRow + 1).value = appendedValue  ' Append column J values with TextBox18 value
                    lastRow = lastRow + 2 ' Move to the next empty row
                End If
                
                If i = 7 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A8:J10").value
                    targetSheet.Range("H" & lastRow + 1 & ":H" & lastRow + 2).value = TextBox21.value  ' Replace column H values with TextBox21 value
                    appendedValue = "" & targetSheet.Cells(lastRow + 1, "J").value & " , " & TextBox22.value
                    targetSheet.Range("J" & lastRow + 1 & ":J" & lastRow + 2).value = appendedValue  ' Append column J values with TextBox22 value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                
                    ' Update selectedCheckboxes
                     selectedCheckboxes = selectedCheckboxes & " Checkbox " & i & ", "
                     
               ElseIf qgc = "QGC2" Then
               
                If i = 2 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A23:J25").value
                    targetSheet.Range("H" & lastRow + 1 & ":H" & lastRow + 2).value = TextBox11.value  ' Replace column H values with TextBox11 value
                    ' Append TextBox12 value to cells in column J of rows 24 and 25
                        targetSheet.Cells(lastRow + 1, "J").value = targetSheet.Cells(lastRow + 1, "J").value & ", " & TextBox12.value
                        targetSheet.Cells(lastRow + 2, "J").value = targetSheet.Cells(lastRow + 2, "J").value & ", " & TextBox12.value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                
                ' Additional logic for CheckBoxes 1 and 3
                If i = 1 Or i = 3 Then
                    ' Check if CheckBoxes 1 and 3 are selected together
                    Dim checkboxes13Selected As Boolean
                    checkboxes13Selected = (Me.CheckBox1.value And Me.CheckBox3.value)
                    
                    ' If CheckBoxes 1 and 3  are selected together,
                    If checkboxes13Selected And i = 1 Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A20:J20").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A26:J28").value
                         ' Replace values in column H
                        targetSheet.Range("H" & lastRow).value = TextBox9.value
                        targetSheet.Range("H" & lastRow + 1).value = TextBox9.value
                        targetSheet.Range("H" & lastRow + 2).value = TextBox13.value
                        
                        ' Append values in column J
                        targetSheet.Range("J" & lastRow).value = targetSheet.Range("J" & lastRow).value & ", " & TextBox10.value
                        targetSheet.Range("J" & lastRow + 1).value = targetSheet.Range("J" & lastRow + 1).value & ", " & TextBox10.value
                        targetSheet.Range("J" & lastRow + 2).value = targetSheet.Range("J" & lastRow + 2).value & ", " & TextBox14.value
                        lastRow = lastRow + 3 ' Move to the next empty row
                    End If
                    
                    ' Clear checkboxes individually if CheckBoxes 1 and 3 are not selected together
                    If i = 1 And Not checkboxes13Selected Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A20:J20").value
                        lastRow = lastRow + 1 ' Move to the next empty row.
                        targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A26:J27").value
                         ' Replace values in column H
                        targetSheet.Range("H" & lastRow).value = TextBox9.value
                        targetSheet.Range("H" & lastRow + 1).value = TextBox10.value
                        
                        ' Append values in column J
                        targetSheet.Range("J" & lastRow).value = targetSheet.Range("J" & lastRow).value & ", " & TextBox9.value
                        targetSheet.Range("J" & lastRow + 1).value = targetSheet.Range("J" & lastRow + 1).value & ", " & TextBox10.value
                        lastRow = lastRow + 2 ' Move to the next empty row
                    End If
                    
                    If i = 3 And Not checkboxes13Selected Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A20:J20").value
                        lastRow = lastRow + 1 ' Move to the next empty row.
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A28:J28").value
                         ' Replace values in column H
                        targetSheet.Range("H" & lastRow).value = TextBox13.value
                        
                        ' Append values in column J
                        targetSheet.Range("J" & lastRow).value = targetSheet.Range("J" & lastRow).value & ", " & TextBox14.value
                        lastRow = lastRow + 1 ' Move to the next empty row
                    End If
                End If
                
                selectedCheckboxes = selectedCheckboxes & " Checkbox " & i & ", "
        
            ElseIf qgc = "QGC4" Then
                If i = 1 Then
                        targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A32:J33").value
                        ' Replace values in column H
                        targetSheet.Range("H" & lastRow).value = TextBox9.value
                        ' Append values in column J
                        targetSheet.Range("J" & lastRow).value = targetSheet.Range("J" & lastRow).value & ", " & TextBox10.value
                        lastRow = lastRow + 2 ' Move to the next empty row
                End If
                If i = 2 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A34:J36").value
                       ' Replace values in column H
                        targetSheet.Range("H" & lastRow + 1).value = TextBox11.value
                        targetSheet.Range("H" & lastRow + 2).value = TextBox11.value
                        
                        ' Append values in column J
                        targetSheet.Range("J" & lastRow + 1).value = targetSheet.Range("J" & lastRow + 1).value & ", " & TextBox12.value
                        targetSheet.Range("J" & lastRow + 2).value = targetSheet.Range("J" & lastRow + 2).value & ", " & TextBox12.value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                If i = 3 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A37:J39").value
                    ' Replace values in column H
                        targetSheet.Range("H" & lastRow + 1).value = TextBox13.value
                        targetSheet.Range("H" & lastRow + 2).value = TextBox13.value
                        
                        ' Append values in column J
                        targetSheet.Range("J" & lastRow + 1).value = targetSheet.Range("J" & lastRow + 1).value & ", " & TextBox14.value
                        targetSheet.Range("J" & lastRow + 2).value = targetSheet.Range("J" & lastRow + 2).value & ", " & TextBox14.value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                If i = 4 Then
                    targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A40:J42").value
                    ' Replace values in column H
                        targetSheet.Range("H" & lastRow + 1).value = TextBox15.value
                        targetSheet.Range("H" & lastRow + 2).value = TextBox15.value
                        
                        ' Append values in column J
                        targetSheet.Range("J" & lastRow + 1).value = targetSheet.Range("J" & lastRow + 1).value & ", " & TextBox16.value
                        targetSheet.Range("J" & lastRow + 2).value = targetSheet.Range("J" & lastRow + 2).value & ", " & TextBox16.value
                    lastRow = lastRow + 3 ' Move to the next empty row
                End If
                
                ' Additional logic for CheckBoxes 1 and 3
                If i = 5 Or i = 6 Then
                    ' Check if CheckBoxes 1 and 3 are selected together
                    Dim checkboxes56Selected As Boolean
                    checkboxes56Selected = (Me.CheckBox5.value And Me.CheckBox6.value)
                    
                    ' If CheckBoxes 1 and 3  are selected together,
                    If checkboxes56Selected And i = 5 Then
                        targetSheet.Range("A" & lastRow).Resize(3, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A43:J45").value
                          ' Replace values in column H
                        targetSheet.Range("H" & lastRow + 1).value = TextBox17.value
                        targetSheet.Range("H" & lastRow + 2).value = TextBox19.value
                        
                        ' Append values in column J
                        targetSheet.Range("J" & lastRow + 1).value = targetSheet.Range("J" & lastRow + 1).value & ", " & TextBox18.value
                        targetSheet.Range("J" & lastRow + 2).value = targetSheet.Range("J" & lastRow + 2).value & ", " & TextBox20.value
                        lastRow = lastRow + 3 ' Move to the next empty row
                    End If
                    
                    ' Clear checkboxes individually if CheckBoxes 1 and 3 are not selected together
                    If i = 5 And Not checkboxes56Selected Then
                          targetSheet.Range("A" & lastRow).Resize(2, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A43:J44").value
                            ' Replace values in column H
                            targetSheet.Range("H" & lastRow + 1).value = TextBox17.value
                            ' Append values in column J
                            targetSheet.Range("J" & lastRow + 1).value = targetSheet.Range("J" & lastRow + 1).value & ", " & TextBox18.value
                        lastRow = lastRow + 2 ' Move to the next empty row
                    End If
                    
                    If i = 6 And Not checkboxes56Selected Then
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A43:J43").value
                        lastRow = lastRow + 1 ' Move to the next empty row
                        targetSheet.Range("A" & lastRow).Resize(1, 10).value = ThisWorkbook.Sheets("Sheet2").Range("A45:J45").value
                            ' Replace values in column H
                            targetSheet.Range("H" & lastRow).value = TextBox19.value
                            ' Append values in column J
                            targetSheet.Range("J" & lastRow).value = targetSheet.Range("J" & lastRow).value & ", " & TextBox20.value
                        lastRow = lastRow + 1 ' Move to the next empty row
                    End If
                  End If
                
                selectedCheckboxes = selectedCheckboxes & " Checkbox " & i & ", "
            
            End If
        End If
     Next i
    
    ' Remove trailing comma and space
    selectedCheckboxes = Left(selectedCheckboxes, Len(selectedCheckboxes) - 2)
    
    ' Display the selected checkboxes
    MsgBox "Selected checkboxes: " & selectedCheckboxes
End Sub
Sub DisableTextBoxes(ParamArray textBoxes() As Variant)
    Dim textBox As Variant
    For Each textBox In textBoxes
        textBox.Enabled = False
    Next textBox
    
End Sub


Private Sub UserForm_Initialize()
    ' Set the worksheet to which data will be copied
     Set ws = Sheets("Sheet3")

    ' Get selected QGC from cell C14 from sheet1
    Dim qgc As String
    qgc = ThisWorkbook.Sheets("Sheet1").Range("C14").value
    
    ' headings in Sheet3 starting from cell A2
    With ThisWorkbook.Sheets("Sheet3")
        .Range("A1:J1").value = Array("Type", "Id", "Summary", "Description", "Parent", "Related", "Filed Against", "Planned For", "Owned By", "Tags")
    End With
    
    
    ' data based on the User selected QGC
    Select Case qgc
      Case "QGC0"
         ' ProcessQGC "QGC0"
        CheckBox1.Caption = "DIA - Completion"
        CheckBox2.Caption = "FSIA (Corresponding BL) - Completion"
        CheckBox3.Caption = "Safety Plan - Draft"
        CheckBox4.Caption = "Bottom-up Analysis - Draft"
        CheckBox5.Caption = "Item Definition - Draft"
        CheckBox6.Caption = "FMEA Project Plan - Draft"
        CheckBox7.Caption = "HARA SG Align - Completion"
        
        Dim k As Integer
        For k = 9 To 22
            Me.Controls("TextBox" & k).Text = ""
        Next k
                       
        Case "QGC2"
        ' ProcessQGC "QGC2"
            CheckBox1.Caption = "FSVAL Planning - Draft"
            CheckBox2.Caption = "FMEA Coversheet - Draft"
            CheckBox3.Caption = "Change Request Analysis -  Completion"
            'Hide checkbox
            CheckBox4.Visible = False
            CheckBox5.Visible = False
            CheckBox6.Visible = False
            CheckBox7.Visible = False
            
            Dim j As Integer
              For j = 9 To 14
                   Me.Controls("TextBox" & j).Text = ""
                Next j
            For j = 15 To 22
                 Me.Controls("TextBox" & j).Visible = False
            Next j
            
        Case "QGC4"
            'ProcessQGC "QGC4"
            CheckBox1.Caption = "Saftey Case - Completion"
            CheckBox2.Caption = "FMEA Coversheet - Completion"
            CheckBox3.Caption = "FTA Coversheet - Completion"
            CheckBox4.Caption = "Safety Assesment - Completion"
            CheckBox5.Caption = "Bottom-up-Analysis - Completion"
            CheckBox6.Caption = "FSVAL Analysis- Completion"
            
            CheckBox7.Visible = False
            
            Dim l As Integer
               For l = 9 To 20
                  Me.Controls("TextBox" & l).Text = ""
               Next l
                
              For l = 21 To 22
                   Me.Controls("TextBox" & l).Visible = False
              Next l
        
        Case "Others"
            CheckBox1.Visible = False
            CheckBox2.Visible = False
            CheckBox3.Visible = False
            CheckBox4.Visible = False
            CheckBox5.Visible = False
            CheckBox6.Visible = False
            CheckBox7.Visible = False
            
            
            Dim n As Integer
              For n = 9 To 22
                   Me.Controls("TextBox" & n).Visible = False
              Next n
            
    End Select
    
    DisableTextBoxes Me.Controls("TextBox9"), Me.Controls("TextBox10"), _
                         Me.Controls("TextBox11"), Me.Controls("TextBox12"), _
                         Me.Controls("TextBox13"), Me.Controls("TextBox14"), _
                         Me.Controls("TextBox15"), Me.Controls("TextBox16"), _
                         Me.Controls("TextBox17"), Me.Controls("TextBox18"), _
                         Me.Controls("TextBox19"), Me.Controls("TextBox20"), _
                         Me.Controls("TextBox21"), Me.Controls("TextBox22")
    ResizeUserForm
    
    ' Define variables
    Dim currentDate As Date
    Dim currentCW As Integer
    Dim i As Integer
    
    ' Update UserForm with default data
    Me.Controls("Label25").Caption = "Recommended Work Items :"
    Me.Controls("Label26").Caption = "Additional Work Items :"
    Me.Controls("Label34").Caption = "Planned For"
    Me.Controls("Label35").Caption = "Tags"
    
    ' Dependency Work Items Headings
    Me.Controls("Label27").Caption = "Deliverable"
    Me.Controls("Label28").Caption = "Summary"
    Me.Controls("Label29").Caption = "Description"
    Me.Controls("Label30").Caption = "Estimate (Hours)"
    Me.Controls("Label31").Caption = "Owned By"
    Me.Controls("Label32").Caption = "Planned For"
 
    TextBox8.Text = ""
    TextBox2.Text = ""
    TextBox3.Text = ""
    TextBox4.Text = ""
    TextBox5.Text = ""
    TextBox23.Text = ""
    
    
    
    'ClearAllInputs
    
    ResizeUserForm
    
    'InitializeComboBox3
    
    ' InitializeComboBox4
End Sub

Private Sub CommandButton3_Click()
        Dim sourceRange As Range
        Dim targetRange As Range
        Dim appendedValue As String
        Dim textBox8Value As String
        Dim textBox2Value As String
        Dim textBox3Value As String
        Dim textBox4Value As String
        Dim textBox5Value As String
        Dim textBox23value As String
        Dim textBox24value As String
        Dim i As Long
        Dim lastRow As Long
        
        ' Get the current values from TextBoxes
        textBox8Value = Trim(TextBox8.value)
        textBox2Value = Trim(TextBox2.value)
        textBox3Value = Trim(TextBox3.value)
        textBox4Value = Trim(TextBox4.value)
        textBox5Value = Trim(TextBox5.value)
        textBox23value = Trim(TextBox23.value)
        textBox24value = Trim(TextBox24.value)
        
        ' Check if the previous value of TextBox8 is different from the current value
        If previousTextBox8Value <> textBox8Value Then
            ' Prompt user if they want to change the Deliverable
            Dim response As VbMsgBoxResult
            If previousTextBox8Value <> "" Then
                response = MsgBox("Do you want to change the Deliverable?", vbYesNo)
                If response = vbYes Then
                    ' Concatenate TextBox8 value for appending
                    appendedValue = "- " & textBox8Value & " (" & textBox2Value & ")"
                    ' Set sourceRange to A48:H49
                    Set sourceRange = Sheets("Sheet2").Range("A48:H49")
                    ' Set targetRange to the last empty row in the same sheet as sourceRange
                    Set targetRange = sourceRange.Parent.Cells(sourceRange.Parent.Rows.Count, "A").End(xlUp).Offset(1, 0).Resize(2, sourceRange.Columns.Count)
                    ' Copy the sourceRange to the targetRange
                    sourceRange.Copy Destination:=targetRange
                    ' Manipulate and store data using Logic 1
                    ManipulateAndStoreData textBox8Value, textBox2Value, textBox3Value, textBox4Value, textBox5Value, textBox23value, textBox24value, 1
                    ' Clear all input controls except TextBox8
                    Call ClearAllInputsExceptTextBox8
                Else
                    ' Concatenate previous TextBox8 value for appending
                    appendedValue = "- " & previousTextBox8Value & " (" & textBox2Value & ")"
                    ' Set sourceRange to A49:H49
                    Set sourceRange = Sheets("Sheet2").Range("A49:H49")
                    ' Set targetRange to the last empty row in the same sheet as sourceRange
                    Set targetRange = sourceRange.Parent.Cells(sourceRange.Parent.Rows.Count, "A").End(xlUp).Offset(1, 0).Resize(1, sourceRange.Columns.Count)
                    ' Copy the sourceRange to the targetRange
                    sourceRange.Copy Destination:=targetRange
                    ' Manipulate and store data using Logic 2
                    ManipulateAndStoreData previousTextBox8Value, textBox2Value, textBox3Value, textBox4Value, textBox5Value, textBox23value, textBox24value, 2
                    ' Clear all input controls except TextBox8
                    Call ClearAllInputsExceptTextBox8
                End If
            End If
        End If
        
        ' Update previousTextBox8Value to the current value
        previousTextBox8Value = textBox8Value
End Sub

Private Sub ManipulateAndStoreData(ByVal textBox8Value As String, ByVal textBox2Value As String, ByVal textBox3Value As String, ByVal textBox4Value As String, ByVal textBox5Value As String, ByVal textBox23value As String, ByVal textBox24value As String, ByVal logic As Integer)
    Dim manipulatedData(1 To 2, 1 To 10) As String
    If logic = 1 Then
        ' Logic 1
        manipulatedData(1, 1) = textBox8Value & " (" & textBox2Value & ")"
        manipulatedData(2, 1) = textBox8Value & " (" & textBox2Value & ")"
        manipulatedData(1, 2) = textBox3Value
        manipulatedData(2, 2) = textBox3Value
        manipulatedData(1, 9) = textBox4Value
        manipulatedData(2, 9) = textBox4Value
        manipulatedData(1, 7) = textBox5Value
        manipulatedData(2, 7) = textBox5Value
        manipulatedData(1, 6) = textBox23value
        manipulatedData(2, 6) = textBox23value
        manipulatedData(1, 8) = textBox24value
        manipulatedData(2, 8) = textBox24value
    ElseIf logic = 2 Then
        ' Logic 2
        manipulatedData(1, 1) = textBox8Value & " (" & textBox2Value & ")"
        manipulatedData(1, 2) = textBox3Value
        manipulatedData(1, 9) = textBox4Value
        manipulatedData(1, 7) = textBox5Value
        manipulatedData(1, 6) = textBox23value
        manipulatedData(1, 8) = textBox24value
    End If
    ' Store manipulated data in the storedDataList collection
    storedDataList.Add manipulatedData
End Sub


Private Sub ClearAllInputsExceptTextBox8()
    ' Clear all input controls except TextBox8
    TextBox2.value = ""
    TextBox3.value = ""
    TextBox4.value = ""
    TextBox5.value = ""
    TextBox23.value = ""
    TextBox24.value = ""
End Sub

Private Sub StoreDataToList(data As Variant)
    ' Add manipulated data to sstoredDataList collection
    storedDataList.Add data
End Sub

Private Sub TextBox4_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    ' Check if the pressed key is a numeric digit (0-9), the Backspace key, or the decimal point
    If Not (KeyAscii >= 48 And KeyAscii <= 57) And KeyAscii <> 8 And KeyAscii <> 46 Then
        ' If the pressed key is not a numeric digit, decimal point, or Backspace, cancel the keypress
        KeyAscii = 0
        ' Display a message to inform user
        MsgBox "Only numeric input is allowed.", vbExclamation
    End If
End Sub

Private Sub ResizeUserForm()
    ' Calculate minimum top position
    Dim minTop As Long
    Dim ctrl As Control
    
    ' minTop with a large value
    minTop = Me.Height
    
    ' find the minimum top position
    For Each ctrl In Me.Controls
        If ctrl.Top < minTop Then
            minTop = ctrl.Top
        End If
    Next ctrl
    
    ' minimize empty space at top
    Me.Top = Me.Top - minTop
End Sub


Private Sub ClearAllInputs()
    ' Clear all input controls
    TextBox8.value = ""
    TextBox2.value = ""
    TextBox3.value = ""
    TextBox4.value = ""
    TextBox5.value = ""
    TextBox23.value = ""
    TextBox24.value = ""
End Sub

Private Function AllFieldsFilled() As Boolean
    ' Check if all required textboxes and combo box are filled
    If ComboBox1.value = "" Or Trim(TextBox2.Text) = "" Or Trim(TextBox3.Text) = "" _
    Or Trim(TextBox4.Text) = "" Or Trim(TextBox5.Text) = "" Or Trim(TextBox6.Text) = "" Then
        AllFieldsFilled = False
    Else
        AllFieldsFilled = True
    End If
End Function

Private Sub CommandButton6_Click()
    'If userData Is Nothing Then
      '  MsgBox "No data to paste.", vbExclamation
     '   Exit Sub
    'End If
    ' Call the PasteUserData
    'PasteUserData

    ' After clearing input controls, paste the data to Sheet3
    'PasteDataToSheet "Sheet3"
     
    ' Clear all userData
    'Set userData = Nothing
     
    ' Clear text boxes for next input
    ClearAllInputs
    
    ' Close the UserForm
    Unload Me
End Sub

