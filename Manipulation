Dim isFirstInput As Boolean
Dim Del_change As Boolean
Dim Story_ID As String

Sub Loader()
    If isFirstInput = False Then
        ProcessRowRange ThisWorkbook.Sheets("Sheet2").Range("A48:K49"), True
        isFirstInput = True
        Call ClearAllInputsExceptTextBox8
        Del_change = True
    Else
        If Del_change = True Then
            If PromptForDeliverableChange() Then
                Call ClearAllInputs
                Del_change = False
                isFirstInput = False
                TextBox8.Enabled = True
            Else
                Call ClearAllInputsExceptTextBox8
                TextBox8.Enabled = False
            End If
        Else
            ProcessRowRange ThisWorkbook.Sheets("Sheet2").Range("A49:K49"), False
            Call ClearAllInputsExceptTextBox8
            Del_change = True
        End If
    End If
    
    MsgBox "Data has been manipulated and pasted to Sheet3.", vbInformation
End Sub

Sub NewDeliverable_Click()
    Dim response As VbMsgBoxResult
    response = MsgBox("Are you sure you want to start a new deliverable?", vbYesNo + vbQuestion, "New Deliverable")
    If response = vbYes Then
        Call ClearAllInputs
        Del_change = True
        isFirstInput = False
        TextBox8.Enabled = True
    Else
        Call ClearAllInputsExceptTextBox8
        TextBox8.Enabled = False
    End If
End Sub

Function PromptForDeliverableChange() As Boolean
    Dim response As VbMsgBoxResult
    response = MsgBox("Are you sure you want to change the deliverable?", vbYesNo + vbQuestion, "Confirm Deliverable Change")
    If response = vbYes Then
        PromptForDeliverableChange = True
    Else
        PromptForDeliverableChange = False
    End If
End Function

Sub ProcessRowRange(rng As Range, ByVal isFirstInstance As Boolean)
    Dim wsDestination As Worksheet
    Dim destinationRange As Range
    Dim lastRow As Long
    Dim startValue As Integer
    Dim i As Integer
    
    Set wsDestination = ThisWorkbook.Sheets("Sheet3")
    lastRow = wsDestination.Cells(wsDestination.Rows.Count, "A").End(xlUp).Row + 1
    
    If isFirstInstance Then
        startValue = ThisWorkbook.Sheets("Sheet2").Range("B48").Value
        For i = 1 To rng.Rows.Count
            wsDestination.Cells(lastRow + i - 1, "B").Value = startValue + i - 1
        Next i
        Story_ID = wsDestination.Cells(lastRow, "B").Value
    Else
        If Del_change Then
            startValue = wsDestination.Cells(lastRow, "B").Value + 1
            For i = 1 To rng.Rows.Count
                wsDestination.Cells(lastRow + i - 1, "B").Value = startValue + i - 1
            Next i
            Story_ID = wsDestination.Cells(lastRow, "B").Value
        Else
            startValue = wsDestination.Cells(lastRow, "B").Value + 1
            For i = 1 To rng.Rows.Count
                wsDestination.Cells(lastRow + i - 1, "B").Value = startValue
            Next i
            Story_ID = wsDestination.Cells(lastRow, "B").Value
        End If
    End If
    
    rng.Copy wsDestination.Cells(lastRow, "A")
    
    ' Manipulate and paste the text box values
    wsDestination.Cells(lastRow, "C").Value = TextBox8.Value & " (" & TextBox2.Value & ")"
    wsDestination.Cells(lastRow, "D").Value = TextBox3.Value
    wsDestination.Cells(lastRow, "K").Value = TextBox4.Value
    wsDestination.Cells(lastRow, "I").Value = TextBox5.Value
    wsDestination.Cells(lastRow, "H").Value = TextBox23.Value
    wsDestination.Cells(lastRow, "J").Value = TextBox24.Value
    
    If isFirstInstance Then
        wsDestination.Cells(lastRow, "E").Value = "#" & Story_ID
    Else
        wsDestination.Cells(lastRow, "E").Value = "#" & Story_ID
        wsDestination.Cells(lastRow, "E").Value = "#" & Story_ID
    End If
End Sub

Sub ClearAllInputsExceptTextBox8()
    TextBox2.Value = ""
    TextBox3.Value = ""
    TextBox4.Value = ""
    TextBox5.Value = ""
    TextBox23.Value = ""
    TextBox24.Value = ""
End Sub

Sub ClearAllInputs()
    TextBox2.Value = ""
    TextBox3.Value = ""
    TextBox4.Value = ""
    TextBox5.Value = ""
    TextBox8.Value = ""
    TextBox23.Value = ""
    TextBox24.Value = ""
End Sub
