' Initialize checkboxes when the form loads
Private Sub UserForm1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    CheckBox1.Tag = "9,10"
    CheckBox2.Tag = "11,12"
    CheckBox3.Tag = "13,14"
    CheckBox4.Tag = "15,16"
    CheckBox5.Tag = "17,18"
    CheckBox6.Tag = "19,20"
    CheckBox7.Tag = "21,22"
End Sub

' Handle the CheckedChanged event for all checkboxes
Private Sub CheckBox_CheckedChanged(sender As Object, e As EventArgs) Handles CheckBox1.CheckedChanged, CheckBox2.CheckedChanged, CheckBox3.CheckedChanged, CheckBox4.CheckedChanged, CheckBox5.CheckedChanged, CheckBox6.CheckedChanged, CheckBox7.CheckedChanged
    Dim checkBox As CheckBox = DirectCast(sender, CheckBox)
    Dim indices As String() = checkBox.Tag.ToString().Split(","c)

    If indices.Length = 2 Then
        Dim startIndex As Integer = Convert.ToInt32(indices(0))
        Dim endIndex As Integer = Convert.ToInt32(indices(1))

        For i As Integer = startIndex To endIndex
            If i >= 0 AndAlso i < TextBoxes.Length Then
                TextBoxes(i).Enabled = checkBox.Checked
            End If
        Next
    End If
End Sub
