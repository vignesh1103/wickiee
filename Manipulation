Private Sub CommandButton3_Click()
    ' Logic for CommandButton3_Click
    Dim sourceRange As Range
    Dim targetRange As Range
    Dim appendedValue As String
    Dim textBox8Value As String
    Dim textBox2Value As String
    Dim textBox3Value As String
    Dim textBox4Value As String
    Dim textBox5Value As String
    Dim textBox23Value As String
    Dim textBox24Value As String
    Dim logic As Integer

    ' Get the current values from TextBoxes
    textBox8Value = Trim(TextBox8.Value)
    textBox2Value = Trim(TextBox2.Value)
    textBox3Value = Trim(TextBox3.Value)
    textBox4Value = Trim(TextBox4.Value)
    textBox5Value = Trim(TextBox5.Value)
    textBox23Value = Trim(TextBox23.Value)
    textBox24Value = Trim(TextBox24.Value)

    ' Check if the previous value of TextBox8 is different from the current value
    If previousTextBox8Value <> textBox8Value Then
        ' Prompt user if they want to change the Deliverable
        Dim response As VbMsgBoxResult
        If previousTextBox8Value <> "" Then
            response = MsgBox("Do you want to change the Deliverable?", vbYesNo)
            If response = vbYes Then
                ' Logic 1
                logic = 1
            Else
                ' Logic 2
                logic = 2
            End If
            ' Update previousTextBox8Value to the current value
            previousTextBox8Value = textBox8Value
            ' Perform data manipulation based on the selected logic
            ManipulateAndPasteData textBox8Value, textBox2Value, textBox3Value, textBox4Value, textBox5Value, textBox23Value, textBox24Value, logic
            ' Clear all input controls except TextBox8
            Call ClearAllInputsExceptTextBox8
        End If
    End If
End Sub

Private Sub ManipulateAndPasteData(ByVal textBox8Value As String, ByVal textBox2Value As String, ByVal textBox3Value As String, ByVal textBox4Value As String, ByVal textBox5Value As String, ByVal textBox23Value As String, ByVal textBox24Value As String, ByVal logic As Integer)
    ' Manipulate data and paste into Sheet3 based on the selected logic (logic 1 or logic 2)
    Dim sourceRange As Range
    Dim targetRange As Range
    Dim appendedValue As String
    
    ' Set sourceRange based on the logic
    If logic = 1 Then
        Set sourceRange = Sheets("Sheet2").Range("A48:J49")
        appendedValue = textBox8Value & " (" & textBox2Value & ")"
    ElseIf logic = 2 Then
        Set sourceRange = Sheets("Sheet2").Range("A49:J49")
        appendedValue = textBox8Value & " (" & textBox2Value & ")"
    End If
    
    ' Set targetRange to the last empty row in Sheet3
    With Sheets("Sheet3")
        lastRow = .Cells(.Rows.Count, "A").End(xlUp).Row + 1
        Set targetRange = .Range("A" & lastRow)
    End With
    
    ' Copy the sourceRange to the targetRange
    sourceRange.Copy Destination:=targetRange
    
    ' Manipulate and paste additional data from TextBoxes to targetRange based on the selected logic
    With targetRange
        .Offset(0, 2).Value = textBox3Value
        .Offset(0, 7).Value = textBox4Value
        .Offset(0, 4).Value = textBox5Value
        .Offset(0, 3).Value = textBox23Value
        .Offset(0, 5).Value = textBox24Value
        ' For logic 1, update C48 and C49
        If logic = 1 Then
            .Offset(0, 2).Value = appendedValue
            .Offset(1, 2).Value = appendedValue
        End If
    End With
End Sub
