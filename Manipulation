Private Sub CommandButton3_Click()
    Dim allFilled As Boolean
    allFilled = CheckAllTextBoxesFilled
    
    If Not allFilled Then
        MsgBox "Please fill in all fields.", vbExclamation
    Else
        ' Call Loader to process the range and paste the data
        Loader
        Call ClearAllInputsExceptTextBox8
    End If
End Sub

Private Function CheckAllTextBoxesFilled() As Boolean
    ' Check if all text boxes are filled
    CheckAllTextBoxesFilled = True
    
    If TextBox2.Value = "" Or TextBox3.Value = "" Or TextBox4.Value = "" Or TextBox5.Value = "" Or TextBox8.Value = "" Or TextBox3.Value = "" Or TextBox22.Value = "" Or TextBox23.Value = "" Then
        CheckAllTextBoxesFilled = False
    End If
End Function
