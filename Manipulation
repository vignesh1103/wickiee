Dim Del_change As String
Dim isFirstInstance As Boolean

Private Sub CommandButton8_Click()
    Dim response As VbMsgBoxResult
    
    response = MsgBox("Are you sure you want to change the deliverable?", vbYesNo)
    
    If response = vbYes Then
        CommandButton3_Click "YES"
    Else
        CommandButton3_Click "NO"
    End If
End Sub

Private Sub CommandButton3_Click(ByVal response As String)
    If isFirstInstance Then
        Del_change = "YES"
        isFirstInstance = False
    ElseIf response = "YES" Then
        Del_change = "YES"
    Else
        Del_change = "NO"
    End If
    
    Additional_Items
End Sub

Private Sub Additional_Items()
    If Del_change = "YES" Then
        ' Clear all inputs and enable TextBox8
        ClearAllInputs
        TextBox8.Enabled = True
        ' Copy row from sheet2 to sheet3
        Dim lastRow As Long
        lastRow = Sheets("Sheet3").Cells(Sheets("Sheet3").Rows.Count, "A").End(xlUp).Row + 1
        Sheets("Sheet2").Rows("48:49").Copy Destination:=Sheets("Sheet3").Range("A" & lastRow)
        ' Manipulate rows in sheet3 using TextBox values
        Sheets("Sheet3").Range("C" & lastRow).Value = TextBox8.Value & " (" & TextBox2.Value & ")"
        Sheets("Sheet3").Range("D" & lastRow).Value = TextBox3.Value
        Sheets("Sheet3").Range("K" & lastRow).Value = TextBox4.Value
        Sheets("Sheet3").Range("I" & lastRow).Value = TextBox5.Value
        Sheets("Sheet3").Range("H" & lastRow).Value = TextBox23.Value
        Sheets("Sheet3").Range("J" & lastRow).Value = TextBox24.Value
    ElseIf Del_change = "NO" Then
        ' Clear all inputs except TextBox8 and disable TextBox8
        ClearAllInputsExceptTextBox8
        TextBox8.Enabled = False
        ' Copy row from sheet2 to sheet3
        Dim lastRow As Long
        lastRow = Sheets("Sheet3").Cells(Sheets("Sheet3").Rows.Count, "A").End(xlUp).Row + 1
        Sheets("Sheet2").Rows("49:49").Copy Destination:=Sheets("Sheet3").Range("A" & lastRow)
        ' Manipulate rows in sheet3 using TextBox values
        Sheets("Sheet3").Range("C" & lastRow).Value = TextBox8.Value & " (" & TextBox2.Value & ")"
        Sheets("Sheet3").Range("D" & lastRow).Value = TextBox3.Value
        Sheets("Sheet3").Range("K" & lastRow).Value = TextBox4.Value
        Sheets("Sheet3").Range("I" & lastRow).Value = TextBox5.Value
        Sheets("Sheet3").Range("H" & lastRow).Value = TextBox23.Value
        Sheets("Sheet3").Range("J" & lastRow).Value = TextBox24.Value
    End If
End Sub

Private Sub ClearAllInputs()
    TextBox2.Value = ""
    TextBox3.Value = ""
    TextBox4.Value = ""
    TextBox5.Value = ""
    TextBox8.Value = ""
    TextBox23.Value = ""
    TextBox24.Value = ""
End Sub

Private Sub ClearAllInputsExceptTextBox8()
    TextBox2.Value = ""
    TextBox3.Value = ""
    TextBox4.Value = ""
    TextBox5.Value = ""
    TextBox23.Value = ""
    TextBox24.Value = ""
End Sub

Private Sub UserForm_Initialize()
    isFirstInstance = True
End Sub
