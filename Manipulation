Dim StoryId As Long
Dim CopyId As Long

Private Sub UserForm_Initialize()
    isFirstUserInput = True
End Sub

Sub Loader()
    Dim wsSource As Worksheet
    Dim lastRow As Long
    
    If isFirstUserInput Then
        isFirstUserInput = False ' Set flag to false after processing first user input
        Set rng = ThisWorkbook.Sheets("Sheet2").Range("A48:J49")
        
        ' Store the value of the last row's B cell in StoryId
        Set wsSource = ThisWorkbook.Sheets("Sheet3")
        lastRow = wsSource.Cells(wsSource.Rows.Count, "B").End(xlUp).Row
        StoryId = wsSource.Range("B" & lastRow).Value
    Else
        If runRange48To49 Then
            Set rng = ThisWorkbook.Sheets("Sheet2").Range("A48:J49")
            
            ' Increment StoryId by 2 rows
            StoryId = StoryId + 2
            ' Copy the 1st row's B value after increment
            CopyId = wsSource.Range("B" & lastRow).Value
        Else
            Set rng = ThisWorkbook.Sheets("Sheet2").Range("A49:J49")
            
            ' Increment StoryId for 1 row
            StoryId = StoryId + 1
            ' Paste CopyId in E column in this row
            wsSource.Range("E" & lastRow).Value = CopyId
        End If
    End If
    
    ProcessRowRange rng
    MsgBox "Work item added.", vbInformation
End Sub
